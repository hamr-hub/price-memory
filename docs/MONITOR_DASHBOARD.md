# Admin Dashboard ç›‘æ§åŠŸèƒ½æ–‡æ¡£

## æ¦‚è¿°

Price Memory Admin Dashboard æä¾›äº†å®Œæ•´çš„å®æ—¶ç›‘æ§åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç³»ç»ŸçŠ¶æ€ã€ä»»åŠ¡æ‰§è¡Œã€ä»·æ ¼å˜åŒ–å’Œå‘Šè­¦ç®¡ç†ç­‰å¤šä¸ªç»´åº¦çš„ç›‘æ§ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ–¥ï¸ å®æ—¶ç›‘æ§ä»ªè¡¨æ¿

- **ç³»ç»Ÿèµ„æºç›‘æ§**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡å®æ—¶ç›‘æ§
- **ä»»åŠ¡çŠ¶æ€ç›‘æ§**: ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€ã€æˆåŠŸç‡ã€é˜Ÿåˆ—é•¿åº¦å®æ—¶è·Ÿè¸ª
- **ä»·æ ¼ç›‘æ§**: å•†å“ä»·æ ¼å®æ—¶å˜åŒ–ã€è¶‹åŠ¿åˆ†æã€å¼‚å¸¸æ£€æµ‹
- **å‘Šè­¦ç›‘æ§**: å‘Šè­¦è§¦å‘ã€å‘é€çŠ¶æ€ã€æˆåŠŸç‡ç»Ÿè®¡
- **WebSocketå®æ—¶é€šä¿¡**: åŸºäºWebSocketçš„å®æ—¶æ•°æ®æ¨é€

### ğŸ“Š æ•°æ®å¯è§†åŒ–

- **å¤šç§å›¾è¡¨ç±»å‹**: æŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾ã€é¥¼å›¾ã€ä»ªè¡¨ç›˜
- **äº¤äº’å¼ç•Œé¢**: æ”¯æŒæ•°æ®ç­›é€‰ã€æ—¶é—´èŒƒå›´é€‰æ‹©
- **å“åº”å¼è®¾è®¡**: é€‚é…å„ç§å±å¹•å°ºå¯¸
- **å®æ—¶åˆ·æ–°**: è‡ªåŠ¨åˆ·æ–°ç›‘æ§æ•°æ®

### ğŸ”— WebSocketé›†æˆ

- **å®æ—¶æ•°æ®æ¨é€**: ä»·æ ¼å˜åŒ–ã€ä»»åŠ¡çŠ¶æ€å®æ—¶æ¨é€
- **å®¢æˆ·ç«¯è®¢é˜…**: æ”¯æŒæŒ‰å•†å“IDè®¢é˜…å®æ—¶æ•°æ®
- **è¿æ¥çŠ¶æ€ç®¡ç†**: WebSocketè¿æ¥çŠ¶æ€å®æ—¶æ˜¾ç¤º
- **é”™è¯¯é‡è¿**: è‡ªåŠ¨é‡è¿æœºåˆ¶

## æ¶æ„è®¾è®¡

### å‰ç«¯æ¶æ„

```
Admin Dashboard
â”œâ”€â”€ MonitorDashboard.tsx          # ä¸»ç›‘æ§é¡µé¢
â”œâ”€â”€ WebSocketTest.tsx             # WebSocketæµ‹è¯•ç»„ä»¶
â”œâ”€â”€ TrendChart.tsx                # è¶‹åŠ¿å›¾è¡¨ç»„ä»¶
â””â”€â”€ services/
    â””â”€â”€ monitorService.ts         # ç›‘æ§æœåŠ¡API
```

### åç«¯æ¶æ„

```
WebSocketæœåŠ¡
â”œâ”€â”€ websocket_handler.py          # WebSocketå¤„ç†å™¨
â”œâ”€â”€ main.py                       # APIè·¯ç”±å’ŒWebSocketé›†æˆ
â””â”€â”€ ç›‘æ§APIç«¯ç‚¹
    â”œâ”€â”€ /system/status            # ç³»ç»ŸçŠ¶æ€
    â”œâ”€â”€ /system/health            # å¥åº·æ£€æŸ¥
    â”œâ”€â”€ /spider/tasks/metrics     # ä»»åŠ¡æŒ‡æ ‡
    â”œâ”€â”€ /products/metrics         # ä»·æ ¼æŒ‡æ ‡
    â”œâ”€â”€ /alerts/metrics           # å‘Šè­¦æŒ‡æ ‡
    â”œâ”€â”€ /spider/tasks/logs        # ä»»åŠ¡æ—¥å¿—
    â””â”€â”€ /products/{id}/history    # ä»·æ ¼å†å²
```

### æ•°æ®æµ

```
1. å‰ç«¯è¿æ¥WebSocket â†’ ws://localhost:8001
2. è®¢é˜…å•†å“ä»·æ ¼æ›´æ–° â†’ {"type": "subscribe", "product_ids": [1,2,3]}
3. åç«¯æ¨é€å®æ—¶æ•°æ® â†’ {"type": "price_update", "product_id": 1, "price": 99.99, ...}
4. å‰ç«¯æ¥æ”¶å¹¶æ›´æ–°UI
5. å®šæœŸè½®è¯¢APIè·å–æ±‡æ€»æŒ‡æ ‡
```

## APIæ¥å£

### ç³»ç»Ÿç›‘æ§æ¥å£

#### GET /system/status
è·å–ç³»ç»ŸçŠ¶æ€å’Œèµ„æºä½¿ç”¨æƒ…å†µ

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "cpu_usage": 45.2,
    "memory_usage": 62.8,
    "disk_usage": 35.1,
    "active_connections": 128,
    "uptime": 86400,
    "today_tasks": 156,
    "total_tasks": 1234,
    "completed_tasks": 1100,
    "pending_tasks": 78
  }
}
```

#### GET /system/health
è·å–ç³»ç»Ÿå¥åº·çŠ¶æ€

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "status": "healthy",
    "services": [
      {
        "name": "database",
        "status": "healthy",
        "message": "æ•°æ®åº“è¿æ¥æ­£å¸¸"
      },
      {
        "name": "browser",
        "status": "healthy",
        "message": "æµè§ˆå™¨æœåŠ¡æ­£å¸¸"
      }
    ],
    "metrics": {
      "cpu_usage": 45.2,
      "memory_usage": 62.8,
      "disk_usage": 35.1,
      "pending_tasks": 78
    }
  }
}
```

### ä»»åŠ¡ç›‘æ§æ¥å£

#### GET /spider/tasks/metrics
è·å–ä»»åŠ¡æ‰§è¡ŒæŒ‡æ ‡

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "total_tasks": 1234,
    "running_tasks": 5,
    "completed_tasks": 1100,
    "failed_tasks": 29,
    "success_rate": 97.6,
    "avg_response_time": 2.45,
    "queue_length": 100
  }
}
```

#### GET /spider/tasks/logs
è·å–ä»»åŠ¡æ‰§è¡Œæ—¥å¿—

**æŸ¥è¯¢å‚æ•°:**
- `page`: é¡µç 
- `size`: æ¯é¡µæ•°é‡
- `status`: ä»»åŠ¡çŠ¶æ€ï¼ˆå¯é€‰ï¼‰
- `product_id`: å•†å“IDï¼ˆå¯é€‰ï¼‰

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "items": [
      {
        "id": 123,
        "product_id": 456,
        "product_name": "iPhone 15",
        "status": "completed",
        "start_time": "2024-01-01T10:00:00Z",
        "end_time": "2024-01-01T10:02:30Z",
        "duration": 150
      }
    ],
    "total": 1000,
    "page": 1,
    "size": 20
  }
}
```

### ä»·æ ¼ç›‘æ§æ¥å£

#### GET /products/metrics
è·å–ä»·æ ¼ç›‘æ§æŒ‡æ ‡

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "total_products": 500,
    "active_products": 450,
    "last_update_time": "2024-01-01T12:00:00Z",
    "avg_price_change": 2.5,
    "price_accuracy": 98.2,
    "scraping_success_rate": 95.8
  }
}
```

#### GET /products/{product_id}/history
è·å–å•†å“ä»·æ ¼å†å²æ•°æ®

**æŸ¥è¯¢å‚æ•°:**
- `start_date`: å¼€å§‹æ—¥æœŸ
- `end_date`: ç»“æŸæ—¥æœŸ
- `granularity`: æ•°æ®ç²’åº¦ï¼ˆhourly/daily/weeklyï¼‰

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": [
    {
      "timestamp": "2024-01-01T10:00:00Z",
      "product_id": 123,
      "price": 99.99,
      "currency": "USD",
      "change": 2.5
    }
  ]
}
```

### å‘Šè­¦ç›‘æ§æ¥å£

#### GET /alerts/metrics
è·å–å‘Šè­¦ç»Ÿè®¡æŒ‡æ ‡

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "total_alerts": 100,
    "triggered_alerts": 85,
    "sent_events": 82,
    "failed_events": 3,
    "success_rate": 96.5
  }
}
```

## WebSocketåè®®

### è¿æ¥åœ°å€
```
ws://localhost:8001
```

### æ¶ˆæ¯æ ¼å¼

#### å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯

**è®¢é˜…å•†å“:**
```json
{
  "type": "subscribe",
  "product_ids": [1, 2, 3]
}
```

**å–æ¶ˆè®¢é˜…:**
```json
{
  "type": "unsubscribe",
  "product_ids": [1, 2]
}
```

**Pingæ¶ˆæ¯:**
```json
{
  "type": "ping"
}
```

#### æœåŠ¡ç«¯æ¨é€æ¶ˆæ¯

**ä»·æ ¼æ›´æ–°:**
```json
{
  "type": "price_update",
  "product_id": 123,
  "price": 99.99,
  "currency": "USD",
  "change": 2.5,
  "timestamp": "2024-01-01T12:00:00Z"
}
```

**ä»»åŠ¡æ›´æ–°:**
```json
{
  "type": "task_update",
  "task_id": 456,
  "status": "completed",
  "product_id": 123,
  "price": 99.99,
  "error_message": null,
  "timestamp": "2024-01-01T12:00:00Z"
}
```

**ç³»ç»ŸçŠ¶æ€:**
```json
{
  "type": "system_status",
  "status": {
    "cpu_usage": 45.2,
    "memory_usage": 62.8
  },
  "timestamp": "2024-01-01T12:00:00Z"
}
```

**é”™è¯¯æ¶ˆæ¯:**
```json
{
  "type": "error",
  "message": "æ— æ•ˆçš„æ¶ˆæ¯ç±»å‹",
  "timestamp": "2024-01-01T12:00:00Z"
}
```

## ä½¿ç”¨æŒ‡å—

### 1. è®¿é—®ç›‘æ§ä»ªè¡¨æ¿

1. å¯åŠ¨å‰ç«¯åº”ç”¨
2. å¯¼èˆªåˆ° `/monitor` é¡µé¢
3. æŸ¥çœ‹å®æ—¶ç›‘æ§æ•°æ®

### 2. WebSocketè¿æ¥

1. ç›‘æ§é¡µé¢ä¼šè‡ªåŠ¨å°è¯•è¿æ¥WebSocket
2. è¿æ¥æˆåŠŸåï¼ŒçŠ¶æ€æ˜¾ç¤ºä¸º"å·²è¿æ¥"
3. å¦‚æœè¿æ¥å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ·æ–°é¡µé¢é‡è¯•

### 3. è®¢é˜…å•†å“ç›‘æ§

1. åœ¨ä»·æ ¼ç›‘æ§æ ‡ç­¾é¡µä¸­
2. é€‰æ‹©è¦ç›‘æ§çš„å•†å“ID
3. ç³»ç»Ÿä¼šè‡ªåŠ¨è®¢é˜…è¯¥å•†å“çš„å®æ—¶ä»·æ ¼æ›´æ–°

### 4. æŸ¥çœ‹ä»»åŠ¡æ—¥å¿—

1. åœ¨ä»»åŠ¡ç›‘æ§æ ‡ç­¾é¡µ
2. æŸ¥çœ‹æœ€è¿‘çš„ä»»åŠ¡æ‰§è¡Œè®°å½•
3. å¯ä»¥æŒ‰çŠ¶æ€ç­›é€‰ä»»åŠ¡

### 5. WebSocketæµ‹è¯•

1. åœ¨ç›‘æ§é¡µé¢çš„WebSocketæµ‹è¯•åŒºåŸŸ
2. ç‚¹å‡»"è¿æ¥"æŒ‰é’®
3. è¾“å…¥å•†å“IDå¹¶ç‚¹å‡»"è®¢é˜…"
4. æŸ¥çœ‹å®æ—¶æ¨é€çš„æ¶ˆæ¯

## æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯ä¼˜åŒ–

- **æ•°æ®ç¼“å­˜**: ä½¿ç”¨ReactçŠ¶æ€ç®¡ç†å‡å°‘APIè°ƒç”¨
- **è™šæ‹ŸåŒ–**: é•¿åˆ—è¡¨ä½¿ç”¨è™šæ‹ŸåŒ–æŠ€æœ¯
- **é˜²æŠ–èŠ‚æµ**: è¾“å…¥æ¡†å’ŒæŒ‰é’®æ“ä½œé˜²æŠ–
- **å›¾ç‰‡æ‡’åŠ è½½**: å›¾ç‰‡èµ„æºæ‡’åŠ è½½

### åç«¯ä¼˜åŒ–

- **è¿æ¥æ± **: WebSocketè¿æ¥æ± ç®¡ç†
- **æ¶ˆæ¯é˜Ÿåˆ—**: ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ç¼“å†²æ¶ˆæ¯
- **æ•°æ®åº“ç´¢å¼•**: å…³é”®å­—æ®µæ·»åŠ ç´¢å¼•
- **ç¼“å­˜ç­–ç•¥**: çƒ­ç‚¹æ•°æ®Redisç¼“å­˜

### WebSocketä¼˜åŒ–

- **å¿ƒè·³æœºåˆ¶**: å®šæœŸping/pongä¿æŒè¿æ¥
- **æ¶ˆæ¯å‹ç¼©**: å¤§æ•°æ®é‡å¯ç”¨å‹ç¼©
- **è¿æ¥é™åˆ¶**: é™åˆ¶å•ä¸ªIPè¿æ¥æ•°
- **è¶…æ—¶å¤„ç†**: è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´

## æ•…éšœæ’é™¤

### WebSocketè¿æ¥å¤±è´¥

**å¯èƒ½åŸå› :**
1. åç«¯WebSocketæœåŠ¡æœªå¯åŠ¨
2. é˜²ç«å¢™é˜»æ­¢ç«¯å£8001
3. ç½‘ç»œè¿æ¥é—®é¢˜

**è§£å†³æ–¹æ³•:**
1. æ£€æŸ¥åç«¯æ—¥å¿—ç¡®è®¤WebSocketæœåŠ¡çŠ¶æ€
2. å¼€æ”¾ç«¯å£8001
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

### æ•°æ®ä¸æ›´æ–°

**å¯èƒ½åŸå› :**
1. WebSocketè¿æ¥æ–­å¼€
2. APIæ¥å£è¿”å›é”™è¯¯
3. å‰ç«¯çŠ¶æ€æœªæ­£ç¡®æ›´æ–°

**è§£å†³æ–¹æ³•:**
1. æ£€æŸ¥WebSocketè¿æ¥çŠ¶æ€
2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
3. åˆ·æ–°é¡µé¢é‡æ–°è·å–æ•°æ®

### ç›‘æ§æŒ‡æ ‡å¼‚å¸¸

**å¯èƒ½åŸå› :**
1. æ•°æ®é‡‡é›†å»¶è¿Ÿ
2. è®¡ç®—é€»è¾‘é”™è¯¯
3. æ•°æ®åº“æŸ¥è¯¢è¶…æ—¶

**è§£å†³æ–¹æ³•:**
1. æ£€æŸ¥æ•°æ®é‡‡é›†æœåŠ¡çŠ¶æ€
2. æŸ¥çœ‹åç«¯æ—¥å¿—
3. ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢

## æ‰©å±•åŠŸèƒ½

### è‡ªå®šä¹‰ç›‘æ§æŒ‡æ ‡

1. åœ¨åç«¯æ·»åŠ æ–°çš„æŒ‡æ ‡è®¡ç®—é€»è¾‘
2. åœ¨å‰ç«¯æ·»åŠ å¯¹åº”çš„å±•ç¤ºç»„ä»¶
3. æ›´æ–°WebSocketæ¶ˆæ¯ç±»å‹

### å‘Šè­¦è§„åˆ™é…ç½®

1. åœ¨å‘Šè­¦ç®¡ç†é¡µé¢é…ç½®å‘Šè­¦è§„åˆ™
2. è®¾ç½®å‘Šè­¦é˜ˆå€¼å’Œé€šçŸ¥æ–¹å¼
3. æŸ¥çœ‹å‘Šè­¦å†å²è®°å½•

### æ•°æ®å¯¼å‡º

1. æ”¯æŒCSVæ ¼å¼å¯¼å‡ºç›‘æ§æ•°æ®
2. æ”¯æŒExcelæ ¼å¼å¯¼å‡ºè¯¦ç»†æŠ¥å‘Š
3. å®šæ—¶è‡ªåŠ¨ç”Ÿæˆç›‘æ§æŠ¥å‘Š

## å®‰å…¨è€ƒè™‘

### è®¤è¯æˆæƒ

- WebSocketè¿æ¥éœ€è¦API Keyè®¤è¯
- å‰ç«¯è¯·æ±‚æºå¸¦è®¤è¯Token
- æ•æ„Ÿæ“ä½œéœ€è¦æƒé™éªŒè¯

### æ•°æ®å®‰å…¨

- WebSocketæ¶ˆæ¯åŠ å¯†ä¼ è¾“
- æ•æ„Ÿæ•°æ®è„±æ•æ˜¾ç¤º
- æ“ä½œæ—¥å¿—å®Œæ•´è®°å½•

### è®¿é—®æ§åˆ¶

- é™åˆ¶WebSocketè¿æ¥æ•°
- è®¾ç½®æ¶ˆæ¯é¢‘ç‡é™åˆ¶
- é˜²æ­¢æ¶æ„è¿æ¥æ”»å‡»